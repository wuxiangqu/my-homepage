webpackJsonp([3],{Chmf:function(t,e,n){var a=n("SN6U");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("4c77de68",a,!0)},Ja6s:function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){n("Chmf")}function o(t){n("mvmo")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),c=function(){function t(e){a(this,t),this.commondType={DRAW_LINE:"line",DRAW_SEGMENT:"segment",DRAW_RECT:"rect",DRAW_CIRCLE:"circle",ERASE:"erase",CLEAR:"clear",GOFORWARD:"forword",GOBACK:"back"},this.canDraw=!1,this.downPoint=null,this.movePoint=null,this.canvasImageData=null,this.eraseRadius=20,this.araseLineWidth=1,this.eraseStrokeStyle="rgba(0,0,0,.5)",this.cacheDatas=[],this.cacheIndex=-1,this.drawType=this.commondType.DRAW_LINE,this.canvas=e.canvas,this.canvas.width=e.width,this.canvas.height=e.height,this.context=this.canvas.getContext("2d"),this.context.lineWidth=e.lineWidth,this.context.lineCap=e.lineCap,this.context.lineJoin=e.lineJoin,this.context.fillStyle=this.context.strokeStyle=e.color,this.canFill=e.canFill,this.bindEvent()}return s(t,[{key:"bindEvent",value:function(){var t=this;this.canvas.addEventListener("mousedown",function(e){t.mousedown(e)},!1),this.canvas.addEventListener("mousemove",function(e){t.mousemove(e)},!1),this.canvas.addEventListener("mouseup",function(e){t.mouseup(e)},!1),this.canvas.addEventListener("mouseout",function(e){t.mouseout(e)},!1)}},{key:"mousedown",value:function(t){this.canDraw=!0;var e=this.windowToCanvas(t);this.downPoint=this.movePoint=e,this.canvasImageData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height)}},{key:"mousemove",value:function(t){if(this.canDraw){var e=this.windowToCanvas(t),n=this.movePoint;switch(this.movePoint=e,this.drawType){case this.commondType.DRAW_LINE:this.drawLine(n,e);break;case this.commondType.DRAW_SEGMENT:this.drawSegment(this.downPoint,e);break;case this.commondType.DRAW_RECT:this.drawRect(this.downPoint,e);break;case this.commondType.DRAW_CIRCLE:this.drawCircle(this.downPoint,e);break;case this.commondType.ERASE:this.erase()}}}},{key:"mouseup",value:function(t){this.drawType===this.commondType.ERASE&&this.context.putImageData(this.canvasImageData,0,0),this.canDraw=!1,this.cacheDatas.push(this.context.getImageData(0,0,this.canvas.width,this.canvas.height)),this.cacheIndex++}},{key:"mouseout",value:function(t){this.canDraw=!1}},{key:"drawLine",value:function(t,e){this.context.save(),this.context.beginPath(),this.context.moveTo(t.x,t.y),this.context.lineTo(e.x,e.y),this.context.stroke(),this.context.restore()}},{key:"drawSegment",value:function(t,e){this.context.save(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.canvasImageData,0,0),this.context.beginPath(),this.context.moveTo(t.x,t.y),this.context.lineTo(e.x,e.y),this.context.stroke(),this.context.restore()}},{key:"drawRect",value:function(t,e){var n=t.x<e.x?t.x:e.x,a=t.y<e.y?t.y:e.y,i=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);this.context.save(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.canvasImageData,0,0),this.context.strokeRect(n,a,i,o),this.canFill&&this.context.fillRect(n,a,i,o),this.context.restore()}},{key:"drawCircle",value:function(t,e){var n=t.x-e.x,a=t.y-e.y,i=Math.sqrt(n*n+a*a);this.context.save(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.canvasImageData,0,0),this.context.beginPath(),this.context.arc(t.x,t.y,i,0,2*Math.PI,!1),this.context.stroke(),this.canFill&&this.context.fill(),this.context.restore()}},{key:"drawEraseCirle",value:function(){this.context.save(),this.context.lineWidth=this.araseLineWidth,this.context.strokeStyle=this.eraseStrokeStyle,this.context.beginPath(),this.context.arc(this.movePoint.x,this.movePoint.y,this.eraseRadius,2*Math.PI,0),this.context.stroke(),this.context.restore()}},{key:"erase",value:function(){var t=this.canvas.width,e=this.canvas.height;this.context.putImageData(this.canvasImageData,0,0),this.context.save(),this.context.strokeStyle=this.eraseStrokeStyle,this.context.beginPath(),this.context.arc(this.movePoint.x,this.movePoint.y,this.eraseRadius,2*Math.PI,0),this.context.clip(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvasImageData=this.context.getImageData(0,0,t,e),this.context.restore(),this.drawEraseCirle()}},{key:"clear",value:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.cacheDatas=[],this.cacheIndex=-1}},{key:"goBack",value:function(){if(this.cacheIndex>0){var t=--this.cacheIndex;this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.cacheDatas[t],0,0)}}},{key:"goForward",value:function(){var t=this.cacheDatas.length;if(this.cacheIndex<t-1){var e=++this.cacheIndex;this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.putImageData(this.cacheDatas[e],0,0)}}},{key:"setDrawType",value:function(t){this.drawType=t}},{key:"setLineWidth",value:function(t){this.context.lineWidth=t}},{key:"setColor",value:function(t){this.context.fillStyle=this.context.strokeStyle=t}},{key:"setCanFill",value:function(t){this.canFill=t}},{key:"windowToCanvas",value:function(t){var e=this.canvas.getBoundingClientRect();return{x:t.clientX-e.left*(this.canvas.width/e.width),y:t.clientY-e.top*(this.canvas.height/e.height)}}}]),t}(),h={props:{lineWidth:{type:Number,default:1},color:{type:String,default:"rgb(0,0,0)"},canFill:{type:Boolean,default:!1},drawType:{type:String,default:"line"}},data:function(){return{board:null}},mounted:function(){var t=this.$refs.canvas,e=t.parentNode.clientWidth,n=t.parentNode.clientHeight;this.board=new c({canvas:t,width:e,height:n,lineWidth:this.lineWidth,lineCap:"round",lineJoin:"round",color:this.color,canFill:this.canFill})},watch:{drawType:function(t){this.board.setDrawType(t)},lineWidth:function(t){this.board.setLineWidth(t)},color:function(t){this.board.setColor(t)},canFill:function(t){this.board.setCanFill(t)}},methods:{clear:function(){this.board.clear()},goForward:function(){this.board.goForward()},goBack:function(){this.board.goBack()}}},r=function(){var t=this,e=t.$createElement;return(t._self._c||e)("canvas",{ref:"canvas"})},l=[],d={render:r,staticRenderFns:l},x=d,v=n("/Xao"),u=i,f=v(h,x,!1,u,null,null),p=f.exports,y={data:function(){return{items:[{drawtype:"line",text:"画笔",isActive:!0},{drawtype:"segment",text:"直线",isActive:!1},{drawtype:"rect",text:"方形",isActive:!1},{drawtype:"circle",text:"圆形",isActive:!1},{drawtype:"erase",text:"板擦",isActive:!1}],clearText:"清空",forwardText:"前进",backText:"后退",lineWidth:2,color:"rgb(14, 85, 224)",canFill:!1,drawType:"line"}},components:{myBoard:p},methods:{setDrawType:function(t){for(var e=t.target,n=e.getAttribute("data-drawtype"),a=0;a<this.items.length;a++){var i=this.items[a];i.drawtype===n?i.isActive=!0:i.isActive=!1}this.drawType=n},clear:function(){this.$refs.board.clear()},goForward:function(){this.$refs.board.goForward()},goBack:function(){this.$refs.board.goBack()}}},m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main-box"},[n("div",{staticClass:"board-box"},[n("my-board",{ref:"board",attrs:{lineWidth:t.lineWidth,color:t.color,canFill:t.canFill,drawType:t.drawType}})],1),t._v(" "),n("div",{staticClass:"tool-box"},[n("div",{staticClass:"draw-type"},t._l(t.items,function(e,a){return n("a",{key:a,class:{active:e.isActive},attrs:{"data-drawtype":e.drawtype},on:{click:t.setDrawType}},[t._v("\n        "+t._s(e.text)+"\n      ")])})),t._v(" "),n("div",{staticClass:"action-type"},[n("a",{on:{click:t.clear}},[t._v(t._s(t.clearText))]),t._v(" "),n("a",{on:{click:t.goForward}},[t._v(t._s(t.forwardText))]),t._v(" "),n("a",{on:{click:t.goBack}},[t._v(t._s(t.backText))])]),t._v(" "),n("div",{staticClass:"options-box"},[n("span",[t._v("线宽：")]),t._v(" "),n("el-slider",{staticStyle:{width:"80px",display:"inline-block"},attrs:{min:1,max:10},model:{value:t.lineWidth,callback:function(e){t.lineWidth=e},expression:"lineWidth"}}),t._v(" "),n("span",[t._v("颜色：")]),t._v(" "),n("el-color-picker",{model:{value:t.color,callback:function(e){t.color=e},expression:"color"}}),t._v(" "),n("el-checkbox",{staticStyle:{"margin-left":"20px"},model:{value:t.canFill,callback:function(e){t.canFill=e},expression:"canFill"}},[n("span",{staticStyle:{"font-size":"16px",color:"#fff"}},[t._v("填充")])])],1)])])},b=[],g={render:m,staticRenderFns:b},w=g,k=n("/Xao"),D=o,T=k(y,w,!1,D,"data-v-4f4fe3ea",null);e.default=T.exports},N4B6:function(t,e,n){e=t.exports=n("BkJT")(!1),e.push([t.i,"\n.main-box[data-v-4f4fe3ea] {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.main-box .board-box[data-v-4f4fe3ea] {\n  position: absolute;\n  left: 3px;\n  right: 3px;\n  top: 3px;\n  bottom: 48px;\n  border: 1px solid #acacac;\n}\n.main-box .tool-box[data-v-4f4fe3ea] {\n  position: absolute;\n  left: 3px;\n  right: 3px;\n  bottom: 3px;\n  height: 40px;\n  border: 1px solid #acacac;\n  background-color: #4a4ebb;\n  overflow: hidden;\n  text-align: center;\n}\n.main-box .tool-box .draw-type[data-v-4f4fe3ea] {\n  display: inline-block;\n}\n.main-box .tool-box .draw-type a[data-v-4f4fe3ea] {\n  display: inline-block;\n  height: 40px;\n  width: 50px;\n  line-height: 40px;\n  text-align: center;\n  color: #fff;\n  cursor: pointer;\n}\n.main-box .tool-box .draw-type a[data-v-4f4fe3ea]:hover {\n  background: #312faf;\n}\n.main-box .tool-box .action-type[data-v-4f4fe3ea] {\n  display: inline-block;\n}\n.main-box .tool-box .action-type a[data-v-4f4fe3ea] {\n  display: inline-block;\n  height: 40px;\n  width: 50px;\n  line-height: 40px;\n  text-align: center;\n  color: #fff;\n  cursor: pointer;\n}\n.main-box .tool-box .action-type a[data-v-4f4fe3ea]:active {\n  background: #312faf;\n}\n.main-box .tool-box .options-box[data-v-4f4fe3ea] {\n  display: -webkit-inline-box;\n  display: -ms-inline-flexbox;\n  display: inline-flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.main-box .tool-box .options-box > span[data-v-4f4fe3ea] {\n  margin-left: 20px;\n  display: inline-block;\n  height: 40px;\n  width: 50px;\n  line-height: 40px;\n  text-align: center;\n  color: #fff;\n}\n.active[data-v-4f4fe3ea] {\n  background: #312faf;\n}\n",""])},SN6U:function(t,e,n){e=t.exports=n("BkJT")(!1),e.push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},mvmo:function(t,e,n){var a=n("N4B6");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("8bSs")("7b30ff44",a,!0)}});